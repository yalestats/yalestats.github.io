<!DOCTYPE html>
<html>
<head>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>

    <title>Topic 5</title>
    <style>
        .hidden {
            display: none;
        }
        .button-container {
            display: flex;
            flex-direction: column;
        }
        .button-container button {
            margin-bottom: 5px;
        }
        .centered-figure {
            display: flex;
      justify-content: center;
    }
    </style>
    <script>
        function toggleVisibility(id) {
            var element = document.getElementById(id);
            
            // Hide only the hidden paragraphs
            var hiddenParagraphs = document.getElementsByClassName('hidden');
            for (var i = 0; i < hiddenParagraphs.length; i++) {
                hiddenParagraphs[i].style.display = 'none';
            }
            
            // Show the selected paragraph
            element.style.display = 'block';
        }
    </script>
</head>
<body>
    <h1>Topic 4: The p-value</h1>
    <div>
        <p>In the previous section, we used the Central Limit Theorem to show that the t-statistic is approximately normal distributed when 
            <span class="mathjax">\(N>30\)</span>. Now we'll use this fact to construct p-values, an important building block of hypothesis testing.
            So what is the p-value?
            </p>
            <p><b>A p-value is the probability of obtaining a 
                test statistic at least as extreme as the one you calculated under the assumption that the null hypothesis is true.</b> </p> 
            <p>
                We use the t-statistic to construct the p-value. How? Suppose you calculate the t-statistic for some sample average. You call 
                this t-statistic <span class="mathjax">\(\hat{t}\)</span>.
            </p>

            <p>
                There are 3 different cases to consider when constructing a p-value:
            </p>


            <p>
                a. The p-value for a one-sided right tail test is given by 
                <div class="centered-figure">
                    <figure>
                        <img src="figures/right_tail.png" alt="right">
                        <figcaption><b>Figure:</b> one-sided right tail hypothesis test</figcaption>
                      </figure>
                    </div>
                
            </p>

            <p>
                b. The p-value for a one-sided left tail test is given by
                <div class="centered-figure">
                    <figure>
                        <img src="figures/left_tail.png" alt="left">
                        <figcaption><b>Figure:</b> one-sided left tail hypothesis test</figcaption>
                      </figure>
                    </div>
                
            </p>

            <p>
                c. The p-value for a two-tail test is given by
                <div class="centered-figure">
                    <figure>
                        <img src="figures/two_sided.png" alt="two_sided">
                        <figcaption><b>Figure:</b> two-tail hypothesis test </figcaption>
                      </figure>
                    </div>
                
            </p>

            <p>
                Because the t-statistic is approximately normally distributed, we know that
                <span class="mathjax">$$\Pr(t \le \hat{t}) = \Phi(\hat{t})$$</span> where <span class="mathjax">\(\Phi(\cdot)\)</span>
                is the standard normal CDF. In practice, you will use R or other statistical software to calculate <span class="mathjax">\(\Phi(\hat{t})\)</span> 
                and find p-values.

            </p>

            <p>
            One last thing: remember that the formula for the t-statistic is
            <span class="mathjax">$$\hat{t} = \frac{\overline{X}-\mu}{s/\sqrt{N}}$$</span>
            Notice that <span class="mathjax">\(\overline{X}\)</span>, <span class="mathjax">\(s\)</span>, and 
            <span class="mathjax">\(N\)</span> are all features of the sample data. So what is <span class="mathjax">\(\mu\)</span>? It
            is the true mean under the assumption that the null hypothesis <span class="mathjax">\(H_0\)</span> is true. In fact, we <b>cannot</b> calculate a test statistic and perform a hypothesis test 
            unless the null hypothesis is assumed to be true. <b>Note:</b> The following practice problem asks you to use R to perform a simulation. For reproducibility, you should use  <span class="mathjax"> \( set.seed(123) \)</span>
            to set a value for the random seed before beginning. <b>If you are confused, try asking ChatGPT before clicking the help button.</b>
        </p>

            <h3>Practice Problem</h3>

            
        <p>- As in the last section, a car manufacturer is deciding whether they should begin offering a new line of electric trucks. They decide that they will offer these new vehicles 
            as long as market research suggests that consumers are willing to offer more than <span class="mathjax">\($55,000\)</span> for the trucks. 
            The manufacturer's marketing team designs a survey to elicit willingness to pay from a set of representative consumers. Suppose that true willingness to pay is
            approximately normally distributed with mean <span class="mathjax">\(\mu = $51,000\)</span> and standard deviation  <span class="mathjax">\(\sigma = $9,000\)</span>
            </p>
            <p>
                1. Using R, construct a random sample of willingness to pay for 100 consumers. 
                Calculate the test statistic and p-value for the difference between these consumers' average willingness to pay and <span class="mathjax">\(\mu = $55,000\)</span>. 
            </p>
            <p>
                2. Construct a vector of 100 consumers with willingness to pay equal to exactly $55,000.
            </p>
            <p>
                3. Now take these two sets of 100 consumer measures of willingness to pay (WTP) and randomly divide them into 2 groups of 100. 
                Calculate the test statistic for the difference in mean WTP between these two groups of 100. 
                Repeat this process 500 times. 
                <b>What does this accomplish?</b> You are simulating test statistics for the case when the 
                difference in average WTP between the surveyed consumers and $55,000 is only due to chance. Equivalently, 
                these simulated test statistics are calculated under the assumption that the null hypothesis is true. 
            </p>
            <p>
            4. Finally, calculate the share of iterations (i.e. <span class="mathjax">\(\frac{\#}{500}\)</span> ) where the value of the test statistic 
            is greater than the test statistic in the original dataset of 100 salaries. 
            This proportion is a simulated p-value. Compare this result with the p-value from the original sample. Are they approximately the same?
            </p>
    </div>

    <div class="button-container">
        <button onclick="toggleVisibility('paragraph0')">I don't know where to start</button>
    </div>
    
    <p id="paragraph0" class="hidden"> First, draw 100 normally 
        distributed random variables at once using the <i>rnorm()</i> command. In the same loop iteration, take the average of these 100 random variables and construct 
        a t-statistic using the formula provided in the previous conceptual section (<b>hint:</b> when the null hypothesis is true, <span class="mathjax">\(\mu = 55,000\)</span>). 
        Next, use the <i>c()</i> command to create a vector representing 100 consumers with WTP = $55,000. Then use the <i>rbind()</i> to combine 
        these two vectors. Next, you should implement a <b>for</b> loop in R. In each step, use the <i>sample()</i> command to split the vector into two random groups. If
    you have trouble implementing this method, don't worry - ChatGPT is quite good at it!</p>


<div class="button-container">
    <button onclick="toggleVisibility('paragraph5')">Click when finished</button>
</div>

<p id="paragraph5" class="hidden"> The simulated p-value and sample p-value should be about the same. The reason is that the simulated p-value is the 
    simulated probability of observing an outcome at least as extreme as the one you got in the original sample conditional 
     on the null hypothesis being true. That's just the empirical counterpart to the definition of a p-value! </p>

     <div>
		<button onclick="openPreviousPage0()">Back to Previous Problem: Stating Hypotheses</button>
		<script>
			function openPreviousPage0() {
				window.location.href = "part3.html";
			}
		</script>
	</div>

    <div>
		<button onclick="openPreviousPage()">Previous Conceptual Topic: Test Statistics</button>
		<script>
			function openPreviousPage() {
				window.location.href = "part4.html";
			}
		</script>
	</div>

	<div>
		<button onclick="openNewPage()">Next Problem: Hypothesis Testing</button>
		<script>
			function openNewPage() {
				window.location.href = "part6.html";
			}
		</script>
	</div>
	
	<script>
        MathJax.Hub.Queue(["Typeset", MathJax.Hub, document.getElementsByClassName("mathjax")]);
      </script>
      
</body>
</html>
